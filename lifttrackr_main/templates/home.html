{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}

   
    {% if user.is_authenticated %}

        <div class="home_logged_in">
            <nav>
                <h1>[[message]]</h1>
                <p><a href="{% url 'logout' %}">Logout</a></p>
            </nav>
            
            <div class="home_main">
                {% csrf_token %}
                <h2><a href="http://127.0.0.1:8000/users/history">History</a></h2>
                <h1>Hi {{user.username}}!</h1>
                
                <p>Lifting since: {{user.date_joined}}</p>
            
                
                <div id="start_work">
                    <div v-if="create_session===false">
                        <h2><a @click="create_session=true">New Workout</a></h2>
                    </div>
                    <div v-if="current_session===true">
                        <session 
                        :currentuser="currentUser"
                        ></session>
                        
                            <br>
                            <hr>
                            <button @click="toggle_categories()">Categories</button>
                            <button @click="toggle_exercises()">List</button>
                            <button @click="finish_session()">Finish Workout</button>
                            <button @click="cancel_workout()">Cancel</button><br>
                            <input id="searchinput" type="text" @keydown.enter="search_exercise()" v-model="search_text" placeholder="Search"/>
                            <button @click="search_exercise()">Search</button>
                            <br>
                            <hr>
                            
                        
                    </div>

                    
                    <div v-if="create_session===true">
                        <div v-if="current_session===false">
                            <input type="text" v-model="session_name" id="session_name" @keydown.enter="newSession()" placeholder="Session Name"/>
                            <button @click="newSession()">Create</button>
                            <button @click="create_session=false">Cancel</button>
                        </div>
                    </div>
                    
                    
                </div>

                <div id="current_work">
                    

                    <template v-if="show_allExercises===true">                        
                        <exercise-item id="ex_list_div"
                        :allexercises="allExercises"
                        ></exercise-item>                        
                    </template>

                    <template v-if="show_allCategories===true">
                        <category-item id="category_div"
                        :allcategories="allCategories"
                        ></category-item>
                    </template>

                    
                    <template v-if="show_results===true">

                        <div id="search_div">
                            <a @click="close_search"><i class="fas fa-times"></i></a>
                            <div>
                                <div v-for="result in search_results">
                                    <p><a @click="add_result(result)"><i class="fas fa-plus"></i> [[result.name]]</p>
                                </div>
                            <div>
                        </div>
                    </template>
                    
                    


                </div>
            </div>
        </div>

            
            


            
        {% else %}
        <div class="home_logged_out_container">
            <div class="home_logged_out">
                <p>You are not logged in</p>
                <a href="{% url 'login' %}">Login</a> 
                <a href="{% url 'signup' %}">Sign Up</a> 
                <a href="{% url 'reset_password' %}">Forgot Password?</a>
            </div>
        </div>
        {% endif %}
        

    {% endblock %}


